version: 1

devin:
  apiVersion: v1
  unlisted: true
  maxAcuLimit: 2
  tags:
    - docdrift

policy:
  prCaps:
    maxPrsPerDay: 3
    maxFilesTouched: 30
  confidence:
    autopatchThreshold: 0.8
  allowlist:
    - "openapi/**"
    - "apps/docs-site/**"
  verification:
    commands:
      - "npm run docs:gen"
      - "npm run docs:build"

docAreas:
  - name: api_reference
    mode: autogen
    owners:
      reviewers: ["datastack/api-owners"]
    detect:
      openapi:
        exportCmd: "npm run openapi:export"
        generatedPath: "openapi/generated.json"
        publishedPath: "apps/docs-site/openapi/openapi.json"
    patch:
      targets:
        - "apps/docs-site/openapi/openapi.json"

  - name: auth_guide
    mode: conceptual
    owners:
      reviewers: ["datastack/platform", "datastack/security"]
    detect:
      paths:
        - match: "apps/api/src/auth/**"
          impacts: ["apps/docs-site/docs/guides/authentication.md"]
    patch:
      requireHumanConfirmation: true
