# yaml-language-server: $schema=./docdrift.schema.json
# 10x simple config: openapi + docsite. Legacy docAreas also supported (see comment below).
version: 1

openapi:
  export: "npm run openapi:export"
  generated: "openapi/generated.json"
  published: "apps/docs-site/openapi/openapi.json"

docsite: "apps/docs-site"

inferMode: false

pathMappings:
  - match: "apps/api/**"
    impacts: ["apps/docs-site/docs/**", "apps/docs-site/openapi/**"]

exclude:
  - "apps/docs-site/blog/**"
  - "**/CHANGELOG*"

requireHumanReview:
  - "apps/docs-site/docs/guides/**"

devin:
  apiVersion: v1
  unlisted: true
  maxAcuLimit: 2
  tags:
    - docdrift
  customInstructions:
    - "DocDrift.md"

policy:
  prCaps:
    maxPrsPerDay: 5
    maxFilesTouched: 30
  confidence:
    autopatchThreshold: 0.8
  allowlist:
    - "openapi/**"
    - "apps/**"
  verification:
    commands:
      - "npm run docs:gen"
      - "npm run docs:build"
  slaDays: 7
  slaLabel: docdrift
  # If false (default): Devin may only edit existing files; no new articles or folders.
  # If true: Devin may add articles, create folders, change IA (conceptual scenarios).
  allowNewFiles: true

# Legacy docAreas (optional when openapi+docsite present).
# If you use docAreas only, we derive openapi/docsite/requireHumanReview from them.
# docAreas:
#   - name: api_reference
#     mode: autogen
#     owners: { reviewers: ["cameronking4"] }
#     detect:
#       openapi:
#         exportCmd: "npm run openapi:export"
#         generatedPath: "openapi/generated.json"
#         publishedPath: "apps/docs-site/openapi/openapi.json"
#     patch: { targets: ["apps/docs-site/openapi/openapi.json"] }
#   - name: auth_guide
#     mode: conceptual
#     owners: { reviewers: ["cameronking4"] }
#     detect:
#       paths:
#         - match: "apps/api/src/auth/**"
#           impacts: ["apps/docs-site/docs/guides/authentication.md"]
#     patch: { requireHumanConfirmation: true }
